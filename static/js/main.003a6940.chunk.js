(this["webpackJsonpreact-exam-app"]=this["webpackJsonpreact-exam-app"]||[]).push([[0],{34:function(e,t,c){},38:function(e,t,c){},39:function(e,t,c){},45:function(e,t,c){},46:function(e,t,c){},47:function(e,t,c){},48:function(e,t,c){},50:function(e,t,c){},51:function(e,t,c){},52:function(e,t,c){},53:function(e,t,c){},54:function(e,t,c){},55:function(e,t,c){},56:function(e,t,c){},57:function(e,t,c){"use strict";c.r(t);var s=c(2),i=c.n(s),n=c(26),a=c.n(n),r=c(5),l=(c(34),c(17)),o=c(8),j=c(6),d=c(22);c(35),c(58);d.a.initializeApp({apiKey:"AIzaSyAXlhk_tqZeTzWvWFhbWWjHpx1RjElaEEk",authDomain:"angular-exam-bea50.firebaseapp.com",projectId:"angular-exam-bea50",storageBucket:"angular-exam-bea50.appspot.com",messagingSenderId:"356341360116",appId:"1:356341360116:web:f62528b7b03b85f94a05a1"});var u=d.a,b=i.a.createContext(),h=(c(38),c(39),c(1));var x=function(){var e=Object(s.useContext)(b);return Object(h.jsxs)("header",{className:"header",children:[Object(h.jsxs)("nav",{className:"nav",children:[Object(h.jsxs)("ul",{children:[Object(h.jsx)("li",{children:Object(h.jsx)(r.b,{to:"/softuni-react-exam/shop",children:"Shop"})}),Object(h.jsx)("li",{children:Object(h.jsx)(r.b,{to:"/softuni-react-exam",children:"About us"})})]}),Object(h.jsx)(r.b,{className:"img",to:"/softuni-react-exam",children:Object(h.jsx)("img",{alt:"site-logo",src:"/softuni-react-exam/images.png"})}),e?Object(h.jsxs)("ul",{children:[Object(h.jsx)("li",{children:Object(h.jsx)(r.b,{to:"/softuni-react-exam/profile",children:"Profile"})}),Object(h.jsx)("li",{children:Object(h.jsx)(r.b,{to:"/softuni-react-exam/logout",children:"Logout"})})]}):Object(h.jsxs)("ul",{children:[Object(h.jsx)("li",{children:Object(h.jsx)(r.b,{to:"/softuni-react-exam/login",children:"Login"})}),Object(h.jsx)("li",{children:Object(h.jsx)(r.b,{to:"/softuni-react-exam/register",children:"Register"})})]})]}),Object(h.jsxs)("h3",{children:["Welcome, ",e?e.displayName:"Guest :)"]}),e?Object(h.jsx)("h3",{className:"cart",children:Object(h.jsx)(r.b,{className:"cart-a",to:"/softuni-react-exam/cart",children:"Shopping Cart"})}):""]})};c(45);var O=function(){return Object(h.jsx)("footer",{className:"footer",children:Object(h.jsx)("p",{children:"Simple e-commerce app to serve as an exam breaker @ Softuni Bulgaria... and all hail React :)"})})};c(46);var p=function(){return Object(h.jsx)("h1",{children:"About Us here"})};c(47),c(48);var m=function(e){var t=e.isAdmin,c=e.item,s=e.id;return Object(h.jsx)("section",{className:"shop-item",children:Object(h.jsxs)(r.b,{to:"/softuni-react-exam/details/".concat(s,"/").concat(t),children:[Object(h.jsx)("h2",{children:c.title}),Object(h.jsxs)("h4",{children:[c.price,"$"]}),Object(h.jsx)("img",{alt:"",src:c.imageUrl})]})})},f=c(29),v=c.n(f);var g=function(e){var t=e.isAdmin,c=Object(s.useState)([]),i=Object(o.a)(c,2),n=i[0],a=i[1];Object(s.useEffect)((function(){u.firestore().collection("products").get().then((function(e){var t=[];e.forEach((function(e){var c=e.data();t.push({id:e.id,info:c})})),a(t)}))}),[]);var r=Object(s.useMemo)((function(){return v.a.debounce((function(e){return function(e){u.firestore().collection("products").get().then((function(t){var c=[];t.forEach((function(e){var t=e.data();c.push({id:e.id,info:t})}));var s=c.filter((function(t){return t.info.title.toLowerCase().includes(e.toLowerCase())}));a(s)}))}(e)}),600)}),[]);return Object(h.jsxs)("section",{className:"shop-section",children:[Object(h.jsx)("input",{onKeyUp:function(e){r(e.target.value)},type:"text",placeholder:"Search"}),Object(h.jsx)("article",{className:"shop-section-list",children:n.map((function(e){return Object(h.jsx)(m,{isAdmin:t,id:e.id,item:e.info},e.id)}))})]})};c(50);var N=function(){var e=Object(s.useContext)(b),t=Object(s.useState)(),c=Object(o.a)(t,2),i=c[0],n=c[1];return e?Object(h.jsx)(j.a,{to:"/softuni-react-exam/shop"}):Object(h.jsxs)("section",{className:"login-page",children:[Object(h.jsx)("article",{children:Object(h.jsx)("p",{className:"err",children:i})}),Object(h.jsx)("form",{onSubmit:function(e){e.preventDefault();var t=e.target.email.value,c=e.target.password.value;u.auth().signInWithEmailAndPassword(t,c).catch((function(e){"auth/user-not-found"===e.code&&n("There is no account corresponding to this email"),"auth/wrong-password"===e.code&&n("Wrong password"),console.log(e)}))},children:Object(h.jsxs)("fieldset",{children:[Object(h.jsx)("legend",{children:"Login Form"}),Object(h.jsxs)("section",{className:"field",children:[Object(h.jsx)("label",{htmlFor:"email",children:"Email"}),Object(h.jsxs)("span",{className:"input",children:[Object(h.jsx)("i",{className:"icon-envelope"}),Object(h.jsx)("input",{type:"text",name:"email",id:"email",placeholder:"email"})]})]}),Object(h.jsxs)("section",{className:"field",children:[Object(h.jsx)("label",{htmlFor:"password",children:"Password"}),Object(h.jsxs)("span",{className:"input",children:[Object(h.jsx)("i",{className:"icon-key"}),Object(h.jsx)("input",{type:"text",name:"password",id:"password",placeholder:"password"})]})]}),Object(h.jsx)("input",{className:"button submit",type:"submit",value:"Login"})]})}),Object(h.jsx)(r.b,{to:"/softuni-react-exam/register",children:Object(h.jsx)("p",{children:"You don't have an account ? Click here to Register"})})]})};c(51);var y=function(e){var t=e.updateUserDisplayNameOnRegister,c=Object(s.useContext)(b),i=Object(s.useState)([]),n=Object(o.a)(i,2),a=n[0],l=n[1];return c?Object(h.jsx)(j.a,{to:"/softuni-react-exam/shop"}):Object(h.jsxs)("section",{className:"register-page",children:[a.length<1?"":Object(h.jsx)("article",{children:null===a||void 0===a?void 0:a.map((function(e){return Object(h.jsx)("p",{className:"err",children:e},e)}))}),Object(h.jsx)("form",{onSubmit:function(e){e.preventDefault();var c=e.target.name.value,s=e.target.email.value,i=e.target.password.value,n=e.target.repeat.value,a=[],r=/^[a-zA-Z0-9.-]{4,}@\w+\.com$/.test(s);c.length<6&&a.push("Your name should be at least 6 chars long!"),i.length<6&&a.push("Your password should be at least 6 chars long!"),n!==i&&a.push("Password and Repeat password should match!"),r||a.push("Your email should be a valid .com email"),l(a),a.length>0||u.auth().createUserWithEmailAndPassword(s,i).then((function(){u.auth().currentUser.updateProfile({displayName:c}).then((function(){t(!0),u.firestore().collection("cart").doc(s).set({cart:[]}),u.firestore().collection("orders").doc(s).set({orders:[]})}))})).catch((function(e){l([e.message])}))},children:Object(h.jsxs)("fieldset",{children:[Object(h.jsx)("legend",{children:"Register Form"}),Object(h.jsxs)("section",{className:"field",children:[Object(h.jsx)("label",{htmlFor:"name",children:"Name"}),Object(h.jsxs)("span",{className:"input",children:[Object(h.jsx)("i",{className:"icon-user"}),Object(h.jsx)("input",{type:"text",name:"name",id:"name",placeholder:"Name"})]})]}),Object(h.jsxs)("section",{className:"field",children:[Object(h.jsx)("label",{htmlFor:"email",children:"Email"}),Object(h.jsxs)("span",{className:"input",children:[Object(h.jsx)("i",{className:"icon-envelope"}),Object(h.jsx)("input",{type:"text",name:"email",id:"email",placeholder:"email"})]})]}),Object(h.jsxs)("section",{className:"field",children:[Object(h.jsx)("label",{htmlFor:"password",children:"Password"}),Object(h.jsxs)("span",{className:"input",children:[Object(h.jsx)("i",{className:"icon-key"}),Object(h.jsx)("input",{type:"text",name:"password",id:"password",placeholder:"password"})]})]}),Object(h.jsxs)("section",{className:"field",children:[Object(h.jsx)("label",{htmlFor:"repeat",children:"Repeat password"}),Object(h.jsxs)("span",{className:"input",children:[Object(h.jsx)("i",{className:"icon-key"}),Object(h.jsx)("input",{type:"text",name:"repeat",id:"repeat",placeholder:"repeat password"})]})]}),Object(h.jsx)("input",{className:"button submit",type:"submit",value:"Register"})]})}),Object(h.jsx)(r.b,{to:"/softuni-react-exam/login",children:Object(h.jsx)("p",{children:"You already have an account ? Click here to Login"})})]})};c(52);var C=function(){var e=Object(s.useState)([]),t=Object(o.a)(e,2),c=t[0],i=t[1],n=Object(s.useContext)(b);return Object(s.useEffect)((function(){n&&u.firestore().collection("orders").doc(n.email).get().then((function(e){var t=e.data();i(null===t||void 0===t?void 0:t.orders)}))}),[n]),n?Object(h.jsxs)("section",{className:"profile",children:[Object(h.jsx)("h1",{children:"Check out your profile info and orders below"}),Object(h.jsxs)("h3",{children:["You email: ",n.email]}),Object(h.jsxs)("h3",{children:["Your name: ",n.displayName]}),0===c.length?Object(h.jsx)("h3",{children:"You haven't placed any orders yet"}):"",null===c||void 0===c?void 0:c.map((function(e,t){return Object(h.jsxs)("div",{className:"order",children:[Object(h.jsxs)("h4",{children:["Order No",t+1," placed on ",e.date,", Total amount: ",Number(e.total).toFixed(2),"$"]}),Object(h.jsxs)("table",{children:[Object(h.jsx)("thead",{children:Object(h.jsxs)("tr",{children:[Object(h.jsx)("th",{children:"Title"}),Object(h.jsx)("th",{children:"Price"}),Object(h.jsx)("th",{children:"Quantity"}),Object(h.jsx)("th",{children:"Total"})]})}),Object(h.jsx)("tbody",{children:e.products.map((function(e){return Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{children:e.title}),Object(h.jsxs)("td",{children:[e.price,"$"]}),Object(h.jsx)("td",{children:e.qty}),Object(h.jsxs)("td",{children:[(Number(e.price)*Number(e.qty)).toFixed(2),"$"]})]},e.id)}))}),Object(h.jsx)("tfoot",{children:Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{children:"------"}),Object(h.jsx)("td",{children:"------"}),Object(h.jsx)("td",{children:"------"}),Object(h.jsxs)("th",{children:[e.total,"$"]})]})})]})]},e.date)}))]}):Object(h.jsx)(j.a,{to:"/softuni-react-exam"})};c(53);var w=function(e){var t=e.history,c=e.match,i=e.userCart,n=e.setUserCart,a=Object(s.useContext)(b),l=Object(s.useState)({}),j=Object(o.a)(l,2),d=j[0],x=j[1],O=null===c||void 0===c?void 0:c.params.id,p=null===c||void 0===c?void 0:c.params.isAdmin;return Object(s.useEffect)((function(){u.firestore().collection("products").doc(O).get().then((function(e){return x(e.data())}))}),[O]),a&&"true"===p?Object(h.jsxs)("section",{className:"details",children:[Object(h.jsx)("h1",{children:d.title}),Object(h.jsx)("img",{alt:"product",src:d.imageUrl}),Object(h.jsx)("p",{children:d.description}),Object(h.jsxs)("article",{children:[Object(h.jsx)("button",{onClick:function(){u.firestore().doc("products/"+O).delete(),t.push("/softuni-react-exam/admin")},children:"Delete"}),Object(h.jsx)(r.b,{to:"/softuni-react-exam/admin/edit/".concat(O),children:Object(h.jsx)("button",{children:"Edit"})})]})]}):Object(h.jsxs)("section",{className:"details",children:[Object(h.jsx)("h1",{children:d.title}),Object(h.jsx)("img",{alt:"product",src:d.imageUrl}),Object(h.jsx)("p",{children:d.description}),a?Object(h.jsx)("button",{onClick:function(){var e=i.slice(),c=e.findIndex((function(e){return e.id===O}));c>=0?e[c].qty++:(d.id=O,d.qty=1,e.push(d)),n(e),u.firestore().collection("cart").doc(a.email).set({cart:e}).then((function(){t.push("/softuni-react-exam/cart")}))},children:"Add to cart"}):Object(h.jsx)(r.b,{to:"/softuni-react-exam/login",children:Object(h.jsx)("button",{children:"Login to buy"})})]})};c(54);var S=function(e){var t=e.total,c=e.userCart,i=e.subOrAdd,n=e.placeOrder,a=e.clearCart;return Object(s.useContext)(b)?0===(null===c||void 0===c?void 0:c.length)?Object(h.jsx)("section",{className:"shop-cart",children:Object(h.jsx)("h1",{children:"You cart is empty"})}):Object(h.jsxs)("section",{className:"shop-cart",children:[Object(h.jsx)("h1",{children:"Check out your cart below"}),Object(h.jsxs)("table",{children:[Object(h.jsx)("thead",{children:Object(h.jsxs)("tr",{children:[Object(h.jsx)("th",{children:"Title"}),Object(h.jsx)("th",{children:"Price"}),Object(h.jsx)("th",{children:"Quantity"}),Object(h.jsx)("th",{children:"Total"})]})}),Object(h.jsx)("tbody",{children:null===c||void 0===c?void 0:c.map((function(e){return Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{children:Object(h.jsx)(r.b,{to:"/softuni-react-exam/details/".concat(e.id),children:e.title})}),Object(h.jsxs)("td",{children:[Number(e.price).toFixed(2),"$"]}),Object(h.jsxs)("td",{children:[Object(h.jsx)("span",{onClick:function(){return i(e.id,"sub")},className:"qty",children:"-"}),e.qty,Object(h.jsx)("span",{onClick:function(){return i(e.id,"add")},className:"qty",children:"+"})]}),Object(h.jsxs)("td",{children:[(Number(e.price)*Number(e.qty)).toFixed(2),"$"]})]},e.id)}))}),Object(h.jsx)("tfoot",{children:Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{children:"------"}),Object(h.jsx)("td",{children:"------"}),Object(h.jsx)("td",{children:"------"}),Object(h.jsxs)("th",{children:[t.toFixed(2),"$"]})]})})]}),Object(h.jsxs)("section",{className:"actions",children:[Object(h.jsx)("button",{onClick:a,children:"Clear Cart"}),Object(h.jsx)("button",{onClick:n,children:"Order Now"})]})]}):Object(h.jsx)(j.a,{to:"/softuni-react-exam/login"})};var E=function(e){var t=e.history,c=e.userCart,i=e.setUserCart,n=Object(s.useContext)(b),a=Object(s.useState)(0),r=Object(o.a)(a,2),l=r[0],j=r[1];Object(s.useEffect)((function(){var e=0;null===c||void 0===c||c.forEach((function(t){e+=+t.price*+t.qty})),j(e)}),[c]);var d=function(){i([]),u.firestore().collection("cart").doc(n.email).set({cart:[]})};return Object(h.jsx)("section",{children:Object(h.jsx)(S,{total:l,userCart:c,subOrAdd:function(e,t){var s=c.slice(),a=s.findIndex((function(t){return t.id===e}));"sub"===t?(s[a].qty--,j((function(e){var t;return e-+(null===(t=s[a])||void 0===t?void 0:t.price)})),0===s[a].qty&&s.splice(a,1)):(s[a].qty++,j((function(e){return e+ +s[a].price}))),i(s),u.firestore().collection("cart").doc(n.email).set({cart:s})},placeOrder:function(){var e=new Date,s=e.toISOString().slice(0,10),i=e.toISOString().slice(11,19),a={total:l.toFixed(2),date:"On ".concat(s," at ").concat(i),products:c};u.firestore().collection("orders").doc(n.email).get().then((function(e){var c=e.data().orders;c.push(a),u.firestore().collection("orders").doc(n.email).set({orders:c}),d(),t.push("/softuni-react-exam/profile")}))},clearCart:d})})};c(55),c(56);var A=function(e){var t=e.match,c=e.history,i=e.doEdit,n=Object(s.useState)({}),a=Object(o.a)(n,2),r=a[0],l=a[1],j=Object(s.useState)([]),d=Object(o.a)(j,2),b=d[0],x=d[1],O=null===t||void 0===t?void 0:t.params.id;return Object(s.useEffect)((function(){u.firestore().collection("products").doc(O).get().then((function(e){l(null===e||void 0===e?void 0:e.data())}))}),[O]),Object(h.jsxs)("section",{className:"create-form",children:[b.length<1?"":Object(h.jsx)("article",{children:null===b||void 0===b?void 0:b.map((function(e){return Object(h.jsx)("p",{className:"err",children:e},e)}))}),Object(h.jsx)("form",{onSubmit:function(e){e.preventDefault();var t=e.target.title.value,s=e.target.price.value,n=e.target.imageUrl.value,a=e.target.description.value,r=[],l=/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)/.test(n);if(t.length>20&&r.push("Title shouldn't be longer than 20 chars!"),!0===isNaN(s)&&r.push("Price should be a valid number!"),l||r.push("Image url should be a valid Url!"),a.length<50&&r.push("Description should be at least 50 chars long!"),x(r),!(r.length>0)){var o={title:t,price:s,imageUrl:n,description:a};"false"===i?(u.firestore().collection("products").add(o),c.push("/softuni-react-exam")):(u.firestore().doc("products/"+O).update(o),c.push("/softuni-react-exam/admin"))}},children:Object(h.jsxs)("fieldset",{children:["false"===i?Object(h.jsx)("legend",{children:"Create new product"}):Object(h.jsxs)("legend",{children:["Edit ",null===r||void 0===r?void 0:r.title]}),Object(h.jsxs)("section",{className:"field",children:[Object(h.jsx)("label",{htmlFor:"title",children:"Title"}),Object(h.jsx)("span",{className:"input",children:Object(h.jsx)("input",{type:"text",name:"title",id:"title",placeholder:"Title",defaultValue:(null===r||void 0===r?void 0:r.title)?r.title:""})})]}),Object(h.jsxs)("section",{className:"field",children:[Object(h.jsx)("label",{htmlFor:"price",children:"Price"}),Object(h.jsx)("span",{className:"input",children:Object(h.jsx)("input",{type:"text",name:"price",id:"price",placeholder:"Price",defaultValue:(null===r||void 0===r?void 0:r.price)?r.price:""})})]}),Object(h.jsxs)("section",{className:"field",children:[Object(h.jsx)("label",{htmlFor:"imageUrl",children:"Image URL"}),Object(h.jsx)("span",{className:"input",children:Object(h.jsx)("input",{type:"text",name:"imageUrl",id:"imageUrl",placeholder:"Image URL",defaultValue:(null===r||void 0===r?void 0:r.imageUrl)?r.imageUrl:""})})]}),Object(h.jsxs)("section",{className:"field",children:[Object(h.jsx)("label",{htmlFor:"description",children:"Description"}),Object(h.jsx)("span",{className:"input",children:Object(h.jsx)("textarea",{name:"description",id:"description",rows:"5",cols:"70",defaultValue:(null===r||void 0===r?void 0:r.description)?r.description:"",placeholder:"Description"})})]}),Object(h.jsx)("input",{className:"button submit",type:"submit",value:"false"===i?"Create new product":"Edit product"})]})})]})};var F=function(e){var t=e.history;return Object(s.useContext)(b)?Object(h.jsxs)("section",{className:"admin",children:[Object(h.jsx)(A,{history:t,doEdit:"false"}),Object(h.jsx)("h2",{children:"Edit and Delete products"}),Object(h.jsx)(g,{isAdmin:"true"})]}):Object(h.jsx)(j.a,{to:"/softuni-react-exam/login"})},U="/softuni-react-exam";var k=function(){var e=Object(s.useState)({}),t=Object(o.a)(e,2),c=t[0],i=t[1],n=Object(s.useState)(!1),a=Object(o.a)(n,2),r=a[0],d=a[1],m=Object(s.useState)([]),f=Object(o.a)(m,2),v=f[0],S=f[1];return Object(s.useEffect)((function(){u.auth().onAuthStateChanged(i)}),[r]),Object(s.useEffect)((function(){c&&u.firestore().collection("cart").doc(c.email).get().then((function(e){var t=e.data();S(null===t||void 0===t?void 0:t.cart)}))}),[c]),Object(h.jsx)(b.Provider,{value:c,children:Object(h.jsxs)("div",{className:"App",children:[Object(h.jsx)(x,{}),Object(h.jsx)("main",{children:Object(h.jsxs)(j.d,{children:[Object(h.jsx)(j.b,{path:U,exact:!0,component:p}),Object(h.jsx)(j.b,{path:"".concat(U,"/shop"),exact:!0,children:Object(h.jsx)(g,{isAdmin:"false"})}),Object(h.jsx)(j.b,{path:"".concat(U,"/admin/edit/:id"),exact:!0,render:function(e){return Object(h.jsx)(A,Object(l.a)(Object(l.a)({},e),{},{doEdit:"true"}))}}),Object(h.jsx)(j.b,{path:"".concat(U,"/admin"),exact:!0,component:F}),Object(h.jsx)(j.b,{path:"".concat(U,"/details/:id/:isAdmin"),exact:!0,render:function(e){return Object(h.jsx)(w,Object(l.a)(Object(l.a)({},e),{},{userCart:v,setUserCart:S}))}}),Object(h.jsx)(j.b,{path:"".concat(U,"/login"),exact:!0,component:N}),Object(h.jsx)(j.b,{path:"".concat(U,"/register"),exact:!0,children:Object(h.jsx)(y,{updateUserDisplayNameOnRegister:d})}),Object(h.jsx)(j.b,{path:"".concat(U,"/cart"),exact:!0,render:function(e){return Object(h.jsx)(E,Object(l.a)(Object(l.a)({},e),{},{setUserCart:S,userCart:v}))}}),Object(h.jsx)(j.b,{path:"".concat(U,"/profile"),exact:!0,component:C}),Object(h.jsx)(j.b,{path:"".concat(U,"/logout"),exact:!0,render:function(){return u.auth().signOut(),Object(h.jsx)(j.a,{to:U})}})]})}),Object(h.jsx)(O,{})]})})},P=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,59)).then((function(t){var c=t.getCLS,s=t.getFID,i=t.getFCP,n=t.getLCP,a=t.getTTFB;c(e),s(e),i(e),n(e),a(e)}))};a.a.render(Object(h.jsx)(i.a.StrictMode,{children:Object(h.jsx)(r.a,{children:Object(h.jsx)(k,{})})}),document.getElementById("root")),P()}},[[57,1,2]]]);
//# sourceMappingURL=main.003a6940.chunk.js.map